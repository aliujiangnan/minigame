{"version":3,"sources":["../../../../../assets/script/view/assets/script/view/LvProgressBar.js"],"names":["cc","Class","extends","Component","properties","items","default","type","require","curIndex","visible","buleCircle","SpriteFrame","yelloCircle","buleRect","yelloRect","start","init","index","parseInt","i","item","labeles","string","node","zIndex","getComponent","Sprite","enabled","updateProgress","level","gameInstance","gameView","levelIndex","n","boxes","spriteFrame","move","runAction","sequence","moveBy","v2","easing","easeQuadraticActionOut","callFunc","x","j","length","bind","reset"],"mappings":"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","file":"LvProgressBar.js","sourceRoot":"../../../../../assets/script/view","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        items:{\n            default:[],\n            type:[require(\"LvProgressItem\")]\n        },\n        curIndex:{\n            default:0,\n            visible:false,\n        },\n        buleCircle:{\n            default:null,\n            type:cc.SpriteFrame\n        },\n        yelloCircle:{\n            default:null,\n            type:cc.SpriteFrame\n        },\n        buleRect:{\n            default:null,\n            type:cc.SpriteFrame\n        },\n        yelloRect:{\n            default:null,\n            type:cc.SpriteFrame\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n    },\n    \n    init(index){\n        let start = parseInt(index / 5);\n        for(let i = 0; i < 3; ++i){\n            let item = this.items[i];\n            item.labeles[0].string = \"\" + (i + 1 + start);\n            item.node.zIndex = i;\n            this.items[i].node.getComponent(cc.Sprite).enabled = i == 0;\n        }\n    },\n\n    updateProgress(){\n        let level = gameInstance.gameView.levelIndex;\n        let n = level % 5;\n        if(n == 0){\n            let item = this.items[this.curIndex];\n            item.boxes[4].spriteFrame = this.yelloRect;\n            this.curIndex++;\n            if(this.curIndex > 2)\n                this.curIndex = 0;\n            this.move();\n        }\n        else{\n            let item = this.items[this.curIndex];\n            item.boxes[0].spriteFrame = this.yelloCircle;\n\n            for(let i = 1; i < n; ++i){\n                item.boxes[i].spriteFrame = this.yelloRect;\n            }\n        }\n    },\n\n    move(){\n        for(let i = 0; i < this.items.length; ++i){\n            let item = this.items[i];\n            item.node.getComponent(cc.Sprite).enabled = true;\n            item.node.runAction(cc.sequence(\n                cc.moveBy(.5,cc.v2(-302,0)).easing(cc.easeQuadraticActionOut()),\n                cc.callFunc(function(){\n                    \n                    if(item.node.x < -150){\n                        let level = gameInstance.gameView.levelIndex;\n                        item.node.x = 604;\n                        let n = parseInt(level / 5);\n                        item.labeles[0].string = (n + 3) + \"\";\n                        item.boxes[0].spriteFrame = this.buleCircle;\n                        item.node.zIndex = n + 2;\n                        for(let j = 1; j < item.boxes.length; ++j){\n                            item.boxes[j].spriteFrame = this.buleRect;\n                        }\n                    }\n\n                    item.node.getComponent(cc.Sprite).enabled = this.curIndex == i;\n                }.bind(this))\n            ))\n        }\n    },\n    \n    reset(){\n        this.curIndex = 0;\n        for(let i = 0; i < this.items.length; ++i){\n            let item = this.items[i];\n            item.node.x = i * 302;\n            item.boxes[0].spriteFrame = this.buleCircle;\n            for(let j = 1; j < item.boxes.length; ++j){\n                item.boxes[j].spriteFrame = this.buleRect;\n            }\n        }\n    }\n});\n"]}