{"version":3,"sources":["../../../../../assets/script/view/assets/script/view/RankItem.js"],"names":["cc","Class","extends","Component","properties","medals","default","type","Node","avatar","Sprite","rankLabel","Label","nameLabel","scoreLabel","start","init","rank","name","score","string","i","length","active","chkstrlen","str","subStr","strlen","charCodeAt","loader","load","err","texture","sprite","SpriteFrame","spriteFrame","node","width","height","bind"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,gBAAO;AACHC,qBAAQ,EADL;AAEHC,kBAAK,CAACP,GAAGQ,IAAJ;AAFF,SAhBC;AAoBRC,gBAAO;AACHH,qBAAQ,IADL;AAEHC,kBAAKP,GAAGU;AAFL,SApBC;AAwBRC,mBAAU;AACNL,qBAAQ,IADF;AAENC,kBAAKP,GAAGY;AAFF,SAxBF;AA4BRC,mBAAU;AACNP,qBAAQ,IADF;AAENC,kBAAKP,GAAGY;AAFF,SA5BF;AAgCRE,oBAAW;AACPR,qBAAQ,IADD;AAEPC,kBAAKP,GAAGY;AAFD;AAhCH,KAHP;;AAyCL;;AAEA;;AAEAG,SA7CK,mBA6CI,CAER,CA/CI;AAiDLC,QAjDK,gBAiDAC,IAjDA,EAiDKR,MAjDL,EAiDYS,IAjDZ,EAiDiBC,KAjDjB,EAiDuB;AACxB,aAAKR,SAAL,CAAeS,MAAf,GAAwBH,QAAQ,CAAR,GAAY,EAAZ,GAAiB,KAAGA,IAA5C;AACA,aAAI,IAAII,IAAI,CAAZ,EAAeA,IAAI,KAAKhB,MAAL,CAAYiB,MAA/B,EAAuC,EAAED,CAAzC;AACI,iBAAKhB,MAAL,CAAYgB,CAAZ,EAAeE,MAAf,GAAwBF,KAAMJ,OAAO,CAArC;AADJ,SAGA,SAASO,SAAT,CAAmBC,GAAnB,EAAuB;AACnB,gBAAIC,SAAS,EAAb;AACA,gBAAIC,SAAS,CAAb;AACA,iBAAI,IAAIN,IAAI,CAAZ,EAAcA,IAAII,IAAIH,MAAtB,EAA8BD,GAA9B,EAAkC;AAC9B,oBAAGI,IAAIG,UAAJ,CAAeP,CAAf,IAAoB,GAAvB,EAA4B;AAC5BM,8BAAU,CAAV,CADA,KAGAA;;AAEA,oBAAGA,UAAU,EAAb,EAAgB;AACZD,8BAAUD,IAAIJ,CAAJ,CAAV;AACH,iBAFD,MAGI;AACAK,8BAAU,IAAV;AACA;AACH;AACJ;;AAED,mBAAOA,MAAP;AACH;AACD,aAAKb,SAAL,CAAeO,MAAf,GAAwBI,UAAUN,IAAV,CAAxB;AACA,aAAKJ,UAAL,CAAgBM,MAAhB,GAAyBD,MAAMG,MAAN,GAAe,CAAf,GAAmB,UAAnB,GAAgC,KAAKH,KAA9D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAnB,WAAG6B,MAAH,CAAUC,IAAV,CAAerB,MAAf,EAAuB,UAAUsB,GAAV,EAAeC,OAAf,EAAwB;AAC3C,gBAAGD,GAAH,EAAO,CAEN,CAFD,MAGI;AACA,oBAAIE,SAAU,IAAIjC,GAAGkC,WAAP,CAAmBF,OAAnB,CAAd;AACA,oBAAIC,SAAU,IAAIjC,GAAGkC,WAAP,CAAmBF,OAAnB,CAAd;AACA,qBAAKvB,MAAL,CAAY0B,WAAZ,GAA0BF,MAA1B;AACA,qBAAKxB,MAAL,CAAY2B,IAAZ,CAAiBC,KAAjB,GAAyB,EAAzB;AACA,qBAAK5B,MAAL,CAAY2B,IAAZ,CAAiBE,MAAjB,GAA0B,EAA1B;AACH;AACJ,SAXsB,CAWrBC,IAXqB,CAWhB,IAXgB,CAAvB;AAYH;AArGI,CAAT","file":"RankItem.js","sourceRoot":"../../../../../assets/script/view","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        medals:{\n            default:[],\n            type:[cc.Node],\n        },\n        avatar:{\n            default:null,\n            type:cc.Sprite,\n        },\n        rankLabel:{\n            default:null,\n            type:cc.Label,\n        },\n        nameLabel:{\n            default:null,\n            type:cc.Label,\n        },\n        scoreLabel:{\n            default:null,\n            type:cc.Label,\n        }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n\n    },\n    \n    init(rank,avatar,name,score){\n        this.rankLabel.string = rank <= 3 ? \"\" : \"\"+rank;\n        for(let i = 0; i < this.medals.length; ++i)\n            this.medals[i].active = i == (rank - 1);\n\n        function chkstrlen(str){\n            var subStr = \"\";\n            var strlen = 0;\n            for(var i = 0;i < str.length; i++){\n                if(str.charCodeAt(i) > 255) //如果是汉字，则字符串长度加2\n                strlen += 2;\n                else\n                strlen++;\n\n                if(strlen <= 10){\n                    subStr += str[i];\n                }\n                else{\n                    subStr += \"..\";\n                    break;\n                }\n            }\n\n            return subStr;\n        }\n        this.nameLabel.string = chkstrlen(name);            \n        this.scoreLabel.string = score.length > 8 ? \"99999999\" : \"\" + score;\n\n        // let image = wx.createImage();\n        // image.onload = function () {\n        //     let texture = new cc.Texture2D();\n        //     texture.initWithElement(image);\n        //     texture.handleLoadedTexture();\n        //     var sprite  = new cc.SpriteFrame(texture);\n        //     this.avatar.spriteFrame = sprite;\n        //     this.avatar.node.width = 88;\n        //     this.avatar.node.height = 88;\n        // }.bind(this);\n        // image.src = avatar;\n\n        cc.loader.load(avatar, function (err, texture) {\n            if(err){\n\n            }\n            else{\n                var sprite  = new cc.SpriteFrame(texture);\n                var sprite  = new cc.SpriteFrame(texture);\n                this.avatar.spriteFrame = sprite;\n                this.avatar.node.width = 88;\n                this.avatar.node.height = 88;\n            }\n        }.bind(this))\n    },\n});\n"]}